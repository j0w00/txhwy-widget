import{texasPath}from"./js/texas-svg.js";$("head").append('<link rel="stylesheet" type="text/css" href="./style.min.css">'),async function(){const mapData=await async function(){return await fetch("./data/data.json").then((response=>response.ok?response.json():"Error")).then((data=>data)).catch((error=>error))}();let selectedMap="map1",selectedPin="pin1",currentHighlight=0;!function(){let maps="",tabs="",highlights="";mapData?.maps?.forEach((({id:mapId,title:title,description:description,color:color,pins:pins})=>{let mapPins="";pins.forEach((({id:pinId,title:title,coordinates:coordinates})=>{const highlightCount=getPinHighlights(mapId,pinId)?.length??0;highlightCount>0&&(mapPins+=`<button\n          class="ss-map__pin ${highlightCount>1?"pin--count":""}"\n          data-pin="${pinId}"\n          data-highlight-count="${highlightCount>1?highlightCount:""}"\n          style="left: ${coordinates[0]}%; bottom: ${coordinates[1]}%;">\n            <i class="fas fa-plus"></i>\n        </button>`)}));maps+=`<div\n      class="ss-map__graphic"\n      id="ss-map__${mapId}"\n      style="--map-color: ${color}; display: none;">\n      ${texasPath}\n      ${mapPins}\n    </div>`;tabs+=`<div\n    class="accordion-item"\n    style="--map-color: ${color}; --map-color-light: ${color}40;">\n      <h3 class="accordion-header" id="heading-${mapId}">\n        <button\n          class="accordion-button"\n          type="button"\n          data-bs-toggle="collapse"\n          data-bs-target="#collapse-${mapId}"\n          aria-expanded="true"\n          aria-controls="collapse-${mapId}"\n          data-map-id="${mapId}"\n          style="background-color: ${color};">\n          ${title}\n        </button>\n      </h3>\n      <div\n        id="collapse-${mapId}"\n        class="accordion-collapse collapse"\n        aria-labelledby="heading-${mapId}"\n        data-bs-parent="#ss-map__tabs"\n        data-map-id="${mapId}">\n          <div class="accordion-body">\n            <div class="accordion-description">\n              ${description}\n            </div>\n            <div class="accordion-map" style="display: none">\n              <div class="ss-map__maps--mobile">\n                <div class="ss-map__graphic--mobile">\n                  ${texasPath}\n                  <div class="ss-map__overlay">${mapPins}</div>\n                </div>\n              </div>\n            </div>\n          </div>\n      </div>\n    </div>`})),mapData?.highlights?.forEach((({title:title,subTitle:subTitle,body:body,bids:bids,website:website,image:image,parentMap:parentMap,parentPin:parentPin},idx)=>{const actions=`<div class="item__actions container-fluid py-3">\n            ${bids?`<div class="item__bids mb-2 mb-md-0 me-md-2">\n                <h6 class="mb-md-0 me-md-3">Bid Proposals</h6>\n                ${bids?.map((bid=>`<a\n                        href="${bid.link}"\n                        target="_blank"\n                        class="btn btn--action mb-2 mb-md-0 me-md-2">\n                        ${bid.title}\n                        <i class="fa-solid fa-share"></i>\n                    </a>`)).join("")}\n            </div>`:""}\n            ${website?`<div class="item__website">\n                <h6 class="mb-md-0 me-md-3">More Information</h6>\n                <a\n                    href="${website}"\n                    target="_blank"\n                    class="btn btn--action mb-2 mb-md-0 me-md-2">\n                    Website\n                </a>\n            </div>`:""}\n        </div>`;highlights+=`<div\n        class="carousel-item"\n        data-highlight-id="${idx}">\n        <div class="carousel-item__inner">\n          <div class="carousel-item__grid">\n            <div\n            class="item__header container-fluid py-3"\n            style="background-color: var(--color-${parentMap});">\n              <h5>${title}</h5>\n              <h6>${subTitle}</h6>\n            </div>\n            <div class="item__image" style="background-image:url('${image}');"></div>\n            <div class="item__body container-fluid py-3">${body}</div>\n          </div>\n          ${actions}\n        </div>\n      </div>`}));const initialHTMLElements=`<div class="container-md py-5">\n    <div class="row">\n      <div class="col-md-6 pe-md-5 ss-map__maps">${maps}</div>\n      <div class="col-md-6 ps-lg-5 ss-map__body">\n        <h2>${mapData?.sectionTitle}</h2>\n        <div class="accordion" id="ss-map__tabs">${tabs}</div>\n      </div>\n    </div>\n  </div>\n\n  <div\n  class="modal fade"\n  id="ss-map__modal"\n  tabindex="-1"\n  aria-labelledby="modal-label"\n  aria-hidden="true"\n  >\n    <div class="modal-dialog modal-xl">\n      <div class="modal-content">\n        <div class="modal-header">\n          <h4 class="modal-title">Modal</h4>\n          <div class="modal-actions">\n            <button\n              type="button"\n              class="btn btn--modal-action"\n              data-bs-target="#ss-map__slider"\n              data-bs-slide="prev"\n            >\n              <i class="fa-solid fa-angle-left"></i>\n              <span class="visually-hidden">Previous</span>\n            </button>\n            <button\n              type="button"\n              class="btn btn--modal-action"\n              data-bs-target="#ss-map__slider"\n              data-bs-slide="next"\n            >\n              <i class="fa-solid fa-angle-right"></i>\n              <span class="visually-hidden">Next</span>\n            </button>\n            <button\n              type="button"\n              class="btn btn--modal-action"\n              data-bs-dismiss="modal"\n              aria-label="Close"\n            >\n              <i class="fa-solid fa-xmark"></i>\n              <span class="visually-hidden">Close</span>\n            </button>\n          </div>\n        </div>\n        <div class="modal-body">\n          <div\n            id="ss-map__slider"\n            class="carousel slide"\n            data-bs-interval="false"\n          >\n            <div class="carousel-inner">${highlights}</div>\n          </div>\n        </div>\n        <div class="modal-footer">\n          <h4 class="modal-title">Modal</h4>\n          <div class="modal-actions">\n            <button\n              type="button"\n              class="btn btn--modal-action"\n              data-bs-target="#ss-map__slider"\n              data-bs-slide="prev"\n            >\n              <i class="fa-solid fa-angle-left"></i>\n              <span class="visually-hidden">Previous</span>\n            </button>\n            <button\n              type="button"\n              class="btn btn--modal-action"\n              data-bs-target="#ss-map__slider"\n              data-bs-slide="next"\n            >\n              <i class="fa-solid fa-angle-right"></i>\n              <span class="visually-hidden">Next</span>\n            </button>\n            <button\n              type="button"\n              class="btn btn--modal-action"\n              data-bs-dismiss="modal"\n              aria-label="Close"\n            >\n              <i class="fa-solid fa-xmark"></i>\n              <span class="visually-hidden">Close</span>\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>`;$("#state-services-map").append(initialHTMLElements)}();const body=document.body,ssMapContainer=document.getElementById("state-services-map"),accordionTabs=document.getElementById("ss-map__tabs"),modal=document.getElementById("ss-map__modal"),highlightModal=new bootstrap.Modal(modal),modalTitleEls=document.querySelectorAll(".modal-title"),slider=document.getElementById("ss-map__slider"),mapGraphics=document.querySelectorAll(".ss-map__graphic"),carouselItems=document.querySelectorAll(".carousel-item"),accordionButtons=document.querySelectorAll(".accordion-button"),accordionContentEls=document.querySelectorAll(".accordion-collapse");function setActiveAccordion(){accordionButtons.forEach((item=>{const mapId=item.dataset?.mapId;mapId!==selectedMap?item.classList?.add("collapsed"):item.classList?.remove("collapsed")})),accordionContentEls.forEach((item=>{const mapId=item.dataset?.mapId,prevClassList=item.previousElementSibling.classList;mapId===selectedMap?(item.classList?.add("show"),prevClassList.add("accordion-open")):(item.classList?.remove("show"),prevClassList.remove("accordion-open"))}))}function setActiveMap(){mapGraphics.forEach((mapGraphic=>{const needle=`ss-map__${selectedMap}`,mapId=mapGraphic.id;mapGraphic.style.display=mapId===needle?"block":"none"}))}function setActiveSlide(){carouselItems.forEach((slide=>{const highlightId=slide.dataset?.highlightId;highlightId==currentHighlight?slide.classList?.add("active"):slide.classList?.remove("active")}))}function setModalTitle(){const selectedMapObject=mapData?.maps.find((map=>map.id===selectedMap)),selectedPinObject=selectedMapObject?.pins.find((pin=>pin.id===selectedPin)),currentHighlightObject=mapData?.highlights[currentHighlight],highlights=getPinHighlights(selectedMap,selectedPin),highlightCount=highlights?.length??0;let currentGroupIndex=highlights.findIndex((highlight=>highlight===currentHighlightObject));currentGroupIndex++,modalTitleEls.forEach((title=>{const modalTitle=highlightCount>1?`${selectedPinObject?.title} (${currentGroupIndex} of ${highlightCount})`:selectedPinObject?.title;title.innerText=modalTitle}))}function getPinHighlights(map,pin){return mapData?.highlights.filter((highlight=>highlight.parentMap===map&&highlight.parentPin===pin))}mapData?.maps?.forEach((({id:mapId,title:title,description:description,color:color,pins:pins})=>{const dataStr=`--color-${mapId}`;ssMapContainer.style.setProperty(dataStr,color)})),setActiveAccordion(),setActiveMap(),setActiveSlide(),ssMapContainer.addEventListener("click",(function(event){event.target.classList?.contains("ss-map__pin")&&(selectedPin=event.target.dataset?.pin,currentHighlight=mapData?.highlights.findIndex((highlight=>highlight.parentMap===selectedMap&&highlight.parentPin===selectedPin)),setModalTitle(),setActiveSlide(),function(){highlightModal.show();const modalBackdrop=document.querySelector(".modal-backdrop");ssMapContainer.append(modalBackdrop),body.style.paddingRight="",body.style.overflow="",body.classList.add("map-modal-open")}())})),accordionTabs.addEventListener("show.bs.collapse",(function(event){const heading=event.target.previousElementSibling;heading.classList.add("accordion-open"),selectedMap=heading.firstElementChild.dataset?.mapId,setActiveMap()})),accordionTabs.addEventListener("hide.bs.collapse",(function(event){event.target.previousElementSibling.classList.remove("accordion-open")})),slider.addEventListener("slide.bs.carousel",(function(event){currentHighlight=event.to,selectedMap=mapData?.highlights[currentHighlight]?.parentMap,selectedPin=mapData?.highlights[currentHighlight]?.parentPin,setModalTitle(),setActiveAccordion(),setActiveMap(),highlightModal.handleUpdate()})),modal.addEventListener("hidden.bs.modal",(function(){body.classList.remove("map-modal-open")}))}();